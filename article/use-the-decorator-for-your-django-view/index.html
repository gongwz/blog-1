<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="视图装饰器可用于限制对某些视图的访问，Django附带一些内置的装饰，如login_required，require_POST或has_permission，它们非常有用，但有时您可能需要以不同的粒度级别限制访问，例如只允许创建模型条目的用户编辑或删除它。 一个简单的方法来解决这个问题，没有在每个函数里面添加一个if语句，就是写一个自定义的装饰器。 示例首先我们需要创建一个项目，名为view_de">
<meta name="keywords" content="安生,Python">
<meta property="og:type" content="article">
<meta property="og:title" content="为你的Django视图使用装饰器">
<meta property="og:url" content="https://blog.ansheng.me/article/use-the-decorator-for-your-django-view/index.html">
<meta property="og:site_name" content="Welcome to ansheng’s blog!">
<meta property="og:description" content="视图装饰器可用于限制对某些视图的访问，Django附带一些内置的装饰，如login_required，require_POST或has_permission，它们非常有用，但有时您可能需要以不同的粒度级别限制访问，例如只允许创建模型条目的用户编辑或删除它。 一个简单的方法来解决这个问题，没有在每个函数里面添加一个if语句，就是写一个自定义的装饰器。 示例首先我们需要创建一个项目，名为view_de">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://blog.ansheng.me/images/2017/01/1484572862.png">
<meta property="og:image" content="https://blog.ansheng.me/images/2017/01/1484572882.png">
<meta property="og:image" content="https://blog.ansheng.me/images/2017/01/1484572908.png">
<meta property="og:image" content="https://blog.ansheng.me/images/2017/01/1484572921.gif">
<meta property="og:updated_time" content="2018-07-27T03:26:40.095Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="为你的Django视图使用装饰器">
<meta name="twitter:description" content="视图装饰器可用于限制对某些视图的访问，Django附带一些内置的装饰，如login_required，require_POST或has_permission，它们非常有用，但有时您可能需要以不同的粒度级别限制访问，例如只允许创建模型条目的用户编辑或删除它。 一个简单的方法来解决这个问题，没有在每个函数里面添加一个if语句，就是写一个自定义的装饰器。 示例首先我们需要创建一个项目，名为view_de">
<meta name="twitter:image" content="https://blog.ansheng.me/images/2017/01/1484572862.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon.ico" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico">
          
        
    
    <!-- title -->
    <title>为你的Django视图使用装饰器</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg active"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg active"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu" style="visibility: visible;">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="//notes.ansheng.me">Notes</a></li>
         
          <li><a href="/article/python-full-stack-way/">PythonFullStackWay</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/article/through-the-browser-to-access-a-site-behind-what-has-gone-through/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/article/django-rest-framework-status-module-learn-the-http-status-code/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
    </span>
    <br/>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#示例"><span class="toc-number">1.</span> <span class="toc-text">示例</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        为你的Django视图使用装饰器
    </h1>



    <div class="meta">
      <span class="postdate">创建日期：</span>
    <div class="postdate">
        <time datetime="2017-05-23T16:00:00.000Z" itemprop="datePublished">2017-05-24</time>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>视图装饰器可用于限制对某些视图的访问，Django附带一些内置的装饰，如<code>login_required</code>，<code>require_POST</code>或<code>has_permission</code>，它们非常有用，但有时您可能需要以不同的粒度级别限制访问，例如只允许创建模型条目的用户编辑或删除它。</p>
<p>一个简单的方法来解决这个问题，没有在每个函数里面添加一个if语句，就是写一个自定义的装饰器。</p>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p>首先我们需要创建一个项目，名为<code>view_decorators</code>:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ django-admin startproject view_decorators</span><br></pre></td></tr></table></figure>
<p>在某个项目下创建一个名为<code>blog</code>的应用程序。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> view_decorators/</span><br><span class="line">$ python3 manage.py startapp blog</span><br></pre></td></tr></table></figure>
<p><code>blog/models.py</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> User</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your models here.</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Article</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    title = models.CharField(max_length=<span class="number">255</span>, verbose_name=<span class="string">'标题'</span>)</span><br><span class="line">    create_by = models.ForeignKey(User, verbose_name=<span class="string">'用户'</span>)</span><br><span class="line">    create_date = models.DateTimeField(auto_created=<span class="keyword">True</span>, verbose_name=<span class="string">'创建时间'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        verbose_name = <span class="string">'文章'</span></span><br><span class="line">        verbose_name_plural = verbose_name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.title</span><br></pre></td></tr></table></figure>
<p>创建装饰器模块</p>
<p>编辑<code>blog/decorators.py</code>文件中创建一个名为<code>user_is_article_author</code>的装饰器</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/use/bin/env python</span></span><br><span class="line"><span class="comment"># _*_ coding:utf-8 __</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.core.exceptions <span class="keyword">import</span> PermissionDenied</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Article</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">user_is_article_author</span><span class="params">(function)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrap</span><span class="params">(request, *args, **kwargs)</span>:</span></span><br><span class="line">        article = Article.objects.get(id=kwargs[<span class="string">'article_id'</span>])</span><br><span class="line">        <span class="keyword">if</span> article.create_by == request.user:</span><br><span class="line">            <span class="keyword">return</span> function(request, *args, **kwargs)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> PermissionDenied</span><br><span class="line"></span><br><span class="line">    wrap.__doc__ = function.__doc__</span><br><span class="line">    wrap.__name__ = function.__name__</span><br><span class="line">    <span class="keyword">return</span> wrap</span><br></pre></td></tr></table></figure>
<p><code>blog/views.py</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> messages</span><br><span class="line"><span class="keyword">from</span> django.contrib.auth.decorators <span class="keyword">import</span> login_required</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render, get_object_or_404, redirect</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Article</span><br><span class="line"><span class="keyword">from</span> .decorators <span class="keyword">import</span> user_is_article_author</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="comment"># 获取所有的文章列表</span></span><br><span class="line">    articles = Article.objects.all()</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">'index.html'</span>, &#123;<span class="string">'articles'</span>: articles&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@login_required</span></span><br><span class="line"><span class="meta">@user_is_article_author</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove</span><span class="params">(request, article_id)</span>:</span></span><br><span class="line">    <span class="comment"># 如果查询不到文章，则直接抛出异常</span></span><br><span class="line">    article = get_object_or_404(Article, id=article_id)</span><br><span class="line">    <span class="comment"># 删除成功之后的提示信息</span></span><br><span class="line">    message = <span class="string">'文章：&#123;0&#125;，删除成功'</span>.format(article.title)</span><br><span class="line">    <span class="comment"># 删除文章</span></span><br><span class="line">    article.delete()</span><br><span class="line">    <span class="comment"># 把message添加到request</span></span><br><span class="line">    messages.success(request, message)</span><br><span class="line">    <span class="comment"># 转到index函数</span></span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">'index'</span>)</span><br></pre></td></tr></table></figure>
<p><code>templates/index.html</code></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">content</span>=<span class="string">"width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.8/css/materialize.min.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"striped"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>创建用户<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>文章标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>创建时间<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">    \&#123;\% for article in articles \%\&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>\&#123;\&#123; article.create_by \&#125;\&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>\&#123;\&#123; article.title \&#125;\&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>\&#123;\&#123; article.create_date \&#125;\&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"\&#123;\% url 'remove' article.id \%\&#125;"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">                    \&#123;\% csrf_token \%\&#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"删除"</span> <span class="attr">class</span>=<span class="string">"btn"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    \&#123;\% endfor \%\&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">\&#123;\% for message in messages \%\&#125;    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-panel teal lighten-2"</span>&gt;</span>\&#123;\&#123; message \&#125;\&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">\&#123;\% endfor \%\&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>blog/admin.py</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Article</span><br><span class="line"></span><br><span class="line"><span class="comment"># Register your models here.</span></span><br><span class="line"></span><br><span class="line">admin.site.register(Article)</span><br></pre></td></tr></table></figure>
<p><code>view_decorators/urls.py</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url</span><br><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> blog.views <span class="keyword">import</span> index, remove</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(<span class="string">r'^admin/'</span>, admin.site.urls),</span><br><span class="line">    url(<span class="string">r'^blog/$'</span>, index, name=<span class="string">'index'</span>),</span><br><span class="line">    url(<span class="string">r'^blog/remove/(?P&lt;article_id&gt;\d+)/$'</span>, remove, name=<span class="string">'remove'</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>由于使用了<code>@login_required</code>装饰器，我们还需要在<code>settings.py</code>文件中定义<code>LOGIN_URL</code>参数：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 未登录的用户跳转到后台登录页面，登录成功之后再跳转回之前的页面</span></span><br><span class="line">LOGIN_URL = <span class="string">'/admin/login/'</span></span><br></pre></td></tr></table></figure>
<p>生成数据库并创建超级用户</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ python3 manage.py makemigrations</span><br><span class="line">$ python3 manage.py migrate</span><br><span class="line"><span class="comment"># 创建的超级用户账号为ansheng密码为ansheng.me</span></span><br><span class="line">$ python3 manage.py createsuperuser</span><br></pre></td></tr></table></figure>
<p>打开<code>http://127.0.0.1:8000/admin/</code>页面，输入刚才创建好的超级管理员账号与密码，登录进去之后创建两个用户，密码随意：</p>
<p><img src="/images/2017/01/1484572862.png" alt="1484572862"></p>
<p>退回上一级页面，添加三篇文章</p>
<p><img src="/images/2017/01/1484572882.png" alt="1484572882"></p>
<p>我们刚才看到有三个用户，所以呢，需要创建三篇文章，每篇文章对应一个用户</p>
<p><img src="/images/2017/01/1484572908.png" alt="1484572908"></p>
<p>打开<code>http://127.0.0.1:8000/blog/</code>页面，试着删除不是其他用户的文章，看看是什么结果。</p>
<p><img src="/images/2017/01/1484572921.gif" alt="1484572921"></p>

  </div>
</article>
<div style="text-align:center">
  <hr>
  <img src="/images/wechat.jpg" alt="wechat" style="width:450px;">
</div>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="//notes.ansheng.me">Notes</a></li>
         
          <li><a href="/article/python-full-stack-way/">PythonFullStackWay</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#示例"><span class="toc-number">1.</span> <span class="toc-text">示例</span></a></li></ol>
    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 ansheng
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="//notes.ansheng.me">Notes</a></li>
         
          <li><a href="/article/python-full-stack-way/">PythonFullStackWay</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-89592236-1', 'auto');
        ga('send', 'pageview');
    </script>


<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'blog-ansheng-me';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


